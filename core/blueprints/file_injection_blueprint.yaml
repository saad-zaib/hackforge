blueprint_id: file_upload_001

name: Unrestricted File Upload

category: file_injection

difficulty_range: [1, 5]

description: |
  File upload vulnerabilities occur when applications allow users to upload files without proper validation. Attackers can upload malicious files like web shells, leading to remote code execution.

variants:
  - Unrestricted File Upload
  - Bypass Extension Filter
  - Bypass Content-Type Filter

entry_points:
  - file_upload
  - http_post_param
  - multipart_form

mutation_axes:
  filters:
    basic:
      - extension_bypass
      - double_extension
    medium:
      - extension_bypass
      - double_extension
      - null_byte
      - case_variation
    advanced:
      - extension_bypass
      - double_extension
      - null_byte
      - case_variation
      - content_type_spoofing
      - magic_bytes
  contexts:
    - avatar_upload
    - document_upload
    - image_gallery
    - file_sharing
    - backup_upload
  sinks:
    - file_system
    - database
    - cloud_storage
  encoding:
    - none
    - base64
    - hex_encoding
  output_contexts:
    - file_path
    - url_response
    - error_message
