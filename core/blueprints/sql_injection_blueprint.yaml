blueprint_id: sqli_001

name: SQL Injection

category: sql_injection

difficulty_range: [1, 5]

description: |
  SQL injection allows attackers to interfere with database queries by injecting malicious SQL code through user input.

infrastructure:
  needs_database: true
  database_type: mysql
  needs_file_system: false
  needs_external_service: false

database_schema:
  tables:
    - name: users
      columns:
        - id INT PRIMARY KEY AUTO_INCREMENT
        - username VARCHAR(50)
        - password VARCHAR(255)
        - email VARCHAR(100)
        - role VARCHAR(20)
    - name: secrets
      columns:
        - id INT PRIMARY KEY AUTO_INCREMENT
        - flag VARCHAR(255)
        - description TEXT
        - created_at TIMESTAMP
  flag_location: secrets.flag

variants:
  - Error-based SQL Injection
  - Union-based SQL Injection
  - Blind SQL Injection

entry_points:
  - http_get_param
  - http_post_param
  - http_get_param

mutation_axes:
  filters:
    basic:
      - name: single_quote
      - name: or_keyword
    medium:
      - name: union_keyword
      - name: select_keyword
    advanced:
      - name: sql_comments
  contexts:
    - name: login_form
    - name: user_search
    - name: profile_view
  sinks:
    - mysqli_query
    - mysqli_real_query
    - mysql_query
    - PDO::query
